<!DOCTYPE html>
<html>
<head>
    <title>Test Trades API</title>
    <style>
        body { background: #1a1a1a; color: #fff; font-family: Arial; padding: 20px; }
        pre { background: #2a2a2a; padding: 20px; border-radius: 5px; }
        .success { color: #4caf50; }
        .error { color: #f44336; }
    </style>
</head>
<body>
    <h1>Testing Trading APIs</h1>
    
    <h2>1. Recent Trades API</h2>
    <pre id="trades-result">Loading...</pre>
    
    <h2>2. Sessions API</h2>
    <pre id="sessions-result">Loading...</pre>
    
    <h2>3. Active Sessions Count</h2>
    <pre id="active-result">Loading...</pre>

    <script>
        // Test recent trades API
        console.log('Testing recent trades API...');
        fetch('/api/recent_trades?limit=10')
            .then(response => {
                console.log('Response received:', response.status);
                const status = response.status;
                return response.text().then(text => ({ status, text }));
            })
            .then(({ status, text }) => {
                console.log('Response data:', text);
                const result = document.getElementById('trades-result');
                result.className = status === 200 ? 'success' : 'error';
                result.textContent = `Status: ${status}\n\n${text}`;
                
                // Also try to parse and display as JSON
                if (status === 200) {
                    try {
                        const trades = JSON.parse(text);
                        result.textContent += `\n\nFound ${trades.length} trades`;
                    } catch (e) {
                        console.error('Failed to parse JSON:', e);
                    }
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                document.getElementById('trades-result').textContent = 'Error: ' + error;
            });
            
        // Test sessions API
        fetch('/api/sessions')
            .then(response => {
                const status = response.status;
                return response.text().then(text => ({ status, text }));
            })
            .then(({ status, text }) => {
                const result = document.getElementById('sessions-result');
                result.className = status === 200 ? 'success' : 'error';
                result.textContent = `Status: ${status}\n\n${text}`;
            })
            .catch(error => {
                document.getElementById('sessions-result').textContent = 'Error: ' + error;
            });
            
        // Test active sessions API
        fetch('/api/session_status/active')
            .then(response => {
                const status = response.status;
                return response.text().then(text => ({ status, text }));
            })
            .then(({ status, text }) => {
                const result = document.getElementById('active-result');
                result.className = status === 200 ? 'success' : 'error';
                result.textContent = `Status: ${status}\n\n${text}`;
            })
            .catch(error => {
                document.getElementById('active-result').textContent = 'Error: ' + error;
            });
    </script>
</body>
</html>